DECLARE FUNCTION GAMMLN! (XX!)
DECLARE FUNCTION RAN1! (IDUM&)
DATA 76.18009173D0,-86.50532033D0,24.01409822D0
DATA -1.231739516D0,.120858003D-2,-.536382D-5,2.50662827465D0
DATA 0.5D0,1.0D0,5.5D0

FUNCTION GAMMLN (XX)
DIM COF#(6)
RESTORE
FOR J = 1 TO 6
  READ COF#(J)
NEXT J
READ STP#
READ HALF#, ONE#, FPF#
X# = XX - ONE#
TMP# = X# + FPF#
TMP# = (X# + HALF#) * LOG(TMP#) - TMP#
SER# = ONE#
FOR J = 1 TO 6
  X# = X# + ONE#
  SER# = SER# + COF#(J) / X#
NEXT J
GAMMLN = TMP# + LOG(STP# * SER#)
ERASE COF#
END FUNCTION

