DECLARE FUNCTION BESSJ0! (X!)
DATA 1.0D0,-0.1098628627D-2,0.2734510407D-4,-0.2073370639D-5
DATA 0.2093887211D-6,-0.1562499995D-1,0.1430488765D-3
DATA -0.6911147651D-5,0.7621095161D-6,-0.934945152D-7
DATA 57568490574.0D0,-13362590354.0D0,651619640.7D0
DATA -11214424.18D0,77392.33017D0,-184.9052456D0
DATA 57568490411.0D0,1029532985.0D0,9494680.718D0,59272.64853D0
DATA 267.8532712D0,1.D0

FUNCTION BESSJ0 (X)
RESTORE
READ P1#, P2#, P3#, P4#, P5#
READ Q1#, Q2#, Q3#, Q4#, Q5#
READ R1#, R2#, R3#, R4#, R5#, R6#
READ S1#, S2#, S3#, S4#, S5#, S6#
IF ABS(X) < 8! THEN
  Y# = X ^ 2
  DUM# = R1# + Y# * (R2# + Y# * (R3# + Y# * (R4# + Y# * (R5# + Y# * R6#))))
  BESSJ0 = DUM# / (S1# + Y# * (S2# + Y# * (S3# + Y# * (S4# + Y# * (S5# + Y# * S6#)))))
ELSE
  AX = ABS(X)
  Z = 8! / AX
  Y# = Z ^ 2
  XX = AX - .785398164#
  DUM# = COS(XX) * (P1# + Y# * (P2# + Y# * (P3# + Y# * (P4# + Y# * P5#))))
  DUM# = DUM# - Z * SIN(XX) * (Q1# + Y# * (Q2# + Y# * (Q3# + Y# * (Q4# + Y# * Q5#))))
  BESSJ0 = SQR(.636619772# / AX) * DUM#
END IF
END FUNCTION

