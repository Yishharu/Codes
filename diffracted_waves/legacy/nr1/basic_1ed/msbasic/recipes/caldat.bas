SUB CALDAT (JULIAN&, MM, ID, IYYY)
IGREG& = 2299161
IF JULIAN& >= IGREG& THEN
  JALPHA& = INT(((JULIAN& - 1867216) - .25) / 36524.25)
  JA& = JULIAN& + 1 + JALPHA& - INT(.25 * JALPHA&)
ELSE
  JA& = JULIAN&
END IF
JB& = JA& + 1524
JC& = INT(6680! + ((JB& - 2439870) - 122.1) / 365.25)
JD& = 365 * JC& + INT(.25 * JC&)
JE& = INT((JB& - JD&) / 30.6001)
ID = JB& - JD& - INT(30.6001 * JE&)
MM = JE& - 1
IF MM > 12 THEN MM = MM - 12
IYYY = JC& - 4715
IF MM > 2 THEN IYYY = IYYY - 1
IF IYYY <= 0 THEN IYYY = IYYY - 1
END SUB

