DECLARE FUNCTION BESSY1! (X!)
DECLARE FUNCTION BESSJ1! (X!)
DATA 1.0D0,0.183105D-2,-0.3516396496D-4,0.2457520174D-5,-0.240337019D-6
DATA 0.04687499995D0,-0.2002690873D-3,0.8449199096D-5,-0.88228987D-6
DATA 0.105787412D-6
DATA -0.4900604943D13,0.1275274390D13,-0.5153438139D11,0.7349264551D9
DATA -0.4237922726D7,0.8511937935D4
DATA 0.2499580570D14,0.4244419664D12,0.3733650367D10,0.2245904002D8
DATA 0.1020426050D6,0.3549632885D3,1.0D0

FUNCTION BESSY1 (X)
RESTORE
READ P1#, P2#, P3#, P4#, P5#
READ Q1#, Q2#, Q3#, Q4#, Q5#
READ R1#, R2#, R3#, R4#, R5#, R6#
READ S1#, S2#, S3#, S4#, S5#, S6#, S7#
IF X < 8! THEN
  Y# = X ^ 2
  NUM# = R1# + Y# * (R2# + Y# * (R3# + Y# * (R4# + Y# * (R5# + Y# * R6#))))
  DUM# = S4# + Y# * (S5# + Y# * (S6# + Y# * S7#))
  DUM# = S1# + Y# * (S2# + Y# * (S3# + Y# * DUM#))
  BESSY1 = X * NUM# / DUM# + .636619772# * (BESSJ1(X) * LOG(X) - 1! / X)
ELSE
  Z = 8! / X
  Y# = Z ^ 2
  XX = X - 2.356194491#
  NUM# = SIN(XX) * (P1# + Y# * (P2# + Y# * (P3# + Y# * (P4# + Y# * P5#))))
  DUM# = Q1# + Y# * (Q2# + Y# * (Q3# + Y# * (Q4# + Y# * Q5#)))
  BESSY1 = SQR(.636619772# / X) * (NUM# + Z * COS(XX) * DUM#)
END IF
END FUNCTION

